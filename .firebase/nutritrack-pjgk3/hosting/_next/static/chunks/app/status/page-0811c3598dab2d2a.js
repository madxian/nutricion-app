(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[557],{172:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},178:(e,r,t)=>{"use strict";t.d(r,{As:()=>l,D3:()=>i,R8:()=>o,jt:()=>c});var a=t(5155),s=t(2115);let n=(0,s.createContext)(void 0),o=e=>{let{children:r,firebaseApp:t,firestore:o,auth:i,functions:l}=e,c=(0,s.useMemo)(()=>({firebaseApp:t,firestore:o,auth:i,functions:l}),[t,o,i,l]);return(0,a.jsx)(n.Provider,{value:c,children:r})},i=()=>{let e=(0,s.useContext)(n);if(void 0===e)throw Error("useFirebase must be used within a FirebaseProvider.");return e},l=()=>{let{auth:e}=i();return e},c=()=>{let{firestore:e}=i();return e}},285:(e,r,t)=>{"use strict";t.d(r,{$:()=>c,r:()=>l});var a=t(5155),s=t(2115),n=t(4253),o=t(2085),i=t(9434);let l=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,r)=>{let{className:t,variant:s,size:o,asChild:c=!1,...d}=e,u=c?n.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(l({variant:s,size:o,className:t})),ref:r,...d})});c.displayName="Button"},2298:(e,r,t)=>{Promise.resolve().then(t.bind(t,4856))},4856:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var a=t(5155),s=t(2115),n=t(5695),o=t(178),i=t(5317),l=t(157);let c=(0,l.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),d=(0,l.A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),u=(0,l.A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var f=t(172),m=t(6695),v=t(285),p=t(5365);function g(){let e=(0,n.useRouter)(),r=(0,n.useSearchParams)(),{firestore:t}=(0,o.D3)(),l=r.get("id"),[g,x]=(0,s.useState)("loading"),[h,N]=(0,s.useState)(null),[b,y]=(0,s.useState)(null),[j,w]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{if(!l)return void e.replace("/");if(!t||!j)return;let r=async()=>{try{let e=(0,i.H9)(t,"payment_references",l),r=await (0,i.x7)(e);if(!r.exists())return;let a=r.data(),s=((null==a?void 0:a.status)||"UNKNOWN").toUpperCase();"APPROVED"===s&&a.registrationCode?(y(a.registrationCode),x("success"),w(!1)):"PENDING"!==s&&"APPROVED"!==s&&(x("declined"),N("Tu pago fue ".concat(String(s).toLowerCase(),". Por favor, intenta de nuevo o contacta a tu banco.")),w(!1))}catch(e){console.error("Firestore getDoc error:",e),x("error"),N("Hubo un error al verificar tu pago. Por favor, contacta a soporte."),w(!1)}};r();let a=setInterval(r,5e3),s=setTimeout(()=>{j&&(x("error"),N("No pudimos confirmar tu pago despu\xe9s de 10 minutos. Si el pago fue debitado, contacta a soporte con tu ID de transacci\xf3n."),w(!1))},6e5);return()=>{clearInterval(a),clearTimeout(s)}},[l,t,e,j]),(0,s.useEffect)(()=>{if("success"===g&&b){let r=setTimeout(()=>{e.push("/registro?code=".concat(b))},2e3);return()=>clearTimeout(r)}},[g,b,e]),l)?(0,a.jsx)("main",{className:"flex min-h-dvh flex-col items-center justify-center bg-background p-4 sm:p-8",children:(0,a.jsxs)(m.Zp,{className:"w-full max-w-md shadow-lg",children:[(0,a.jsxs)(m.aR,{children:[(0,a.jsx)(m.ZB,{className:"text-center",children:"Procesando tu Acceso"}),(0,a.jsx)(m.BT,{className:"text-center",children:"Verificando tu transacci\xf3n. Por favor, no cierres esta p\xe1gina."})]}),(0,a.jsx)(m.Wu,{children:(()=>{switch(g){case"success":return(0,a.jsxs)(p.Fc,{variant:"default",className:"border-green-500 bg-green-50 text-green-800",children:[(0,a.jsx)(c,{className:"h-5 w-5 text-green-600"}),(0,a.jsx)(p.XL,{className:"font-bold",children:"\xa1Pago Aprobado!"}),(0,a.jsx)(p.TN,{children:"\xa1Excelente! Tu pago ha sido procesado con \xe9xito. En un momento ser\xe1s redirigido a la p\xe1gina de registro con tu c\xf3digo."})]});case"declined":return(0,a.jsxs)(p.Fc,{variant:"destructive",children:[(0,a.jsx)(d,{className:"h-5 w-5"}),(0,a.jsx)(p.XL,{className:"font-bold",children:"Pago Rechazado"}),(0,a.jsx)(p.TN,{children:h}),(0,a.jsx)(v.$,{variant:"outline",className:"mt-4 w-full",onClick:()=>e.push("/checkout"),children:"Volver a Intentar"})]});case"error":return(0,a.jsxs)(p.Fc,{variant:"destructive",children:[(0,a.jsx)(u,{className:"h-5 w-5"}),(0,a.jsx)(p.XL,{className:"font-bold",children:"Error al verificar"}),(0,a.jsx)(p.TN,{children:h}),(0,a.jsx)(v.$,{variant:"outline",className:"mt-4 w-full",onClick:()=>e.push("/checkout"),children:"Volver a Intentar"})]});default:return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,a.jsx)(f.A,{className:"h-12 w-12 animate-spin text-primary mb-4"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"Confirmando tu pago..."}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Estamos esperando la confirmaci\xf3n de Wompi. Esto puede tomar un momento."})]})}})()})]})}):null}},5365:(e,r,t)=>{"use strict";t.d(r,{Fc:()=>l,TN:()=>d,XL:()=>c});var a=t(5155),s=t(2115),n=t(2085),o=t(9434);let i=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=s.forwardRef((e,r)=>{let{className:t,variant:s,...n}=e;return(0,a.jsx)("div",{ref:r,role:"alert",className:(0,o.cn)(i({variant:s}),t),...n})});l.displayName="Alert";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h5",{ref:r,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",t),...s})});c.displayName="AlertTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",t),...s})});d.displayName="AlertDescription"},6695:(e,r,t)=>{"use strict";t.d(r,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>o,aR:()=>i,wL:()=>u});var a=t(5155),s=t(2115),n=t(9434);let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});o.displayName="Card";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});l.displayName="CardTitle";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...s})});d.displayName="CardContent";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...s})});u.displayName="CardFooter"},9434:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var a=t(2596),s=t(9688);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.QP)((0,a.$)(r))}}},e=>{var r=r=>e(e.s=r);e.O(0,[992,712,612,577,441,684,358],()=>r(2298)),_N_E=e.O()}]);